I'll create a comprehensive Java program with TestNG that demonstrates custom annotations for test categorization and parallel execution using XML configuration.

## Project Structure
```
testng-annotations-demo/
â”œâ”€â”€ pom.xml
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â””â”€â”€ java/
â”‚   â”‚       â””â”€â”€ com/
â”‚   â”‚           â””â”€â”€ example/
â”‚   â”‚               â”œâ”€â”€ annotations/
â”‚   â”‚               â”‚   â”œâ”€â”€ SmokeTest.java
â”‚   â”‚               â”‚   â”œâ”€â”€ RegressionTest.java
â”‚   â”‚               â”‚   â””â”€â”€ PerformanceTest.java
â”‚   â”‚               â”œâ”€â”€ service/
â”‚   â”‚               â”‚   â”œâ”€â”€ UserService.java
â”‚   â”‚               â”‚   â”œâ”€â”€ PaymentService.java
â”‚   â”‚               â”‚   â””â”€â”€ InventoryService.java
â”‚   â”‚               â””â”€â”€ model/
â”‚   â”‚                   â”œâ”€â”€ User.java
â”‚   â”‚                   â”œâ”€â”€ Product.java
â”‚   â”‚                   â””â”€â”€ Order.java
â”‚   â””â”€â”€ test/
â”‚       â””â”€â”€ java/
â”‚           â””â”€â”€ com/
â”‚               â””â”€â”€ example/
â”‚                   â”œâ”€â”€ tests/
â”‚                   â”‚   â”œâ”€â”€ UserServiceTest.java
â”‚                   â”‚   â”œâ”€â”€ PaymentServiceTest.java
â”‚                   â”‚   â”œâ”€â”€ InventoryServiceTest.java
â”‚                   â”‚   â””â”€â”€ ComprehensiveTest.java
â”‚                   â””â”€â”€ listeners/
â”‚                       â””â”€â”€ CustomTestListener.java
â”œâ”€â”€ testng-smoke.xml
â”œâ”€â”€ testng-regression.xml
â”œâ”€â”€ testng-parallel.xml
â””â”€â”€ testng-comprehensive.xml
```

## 1. pom.xml
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
                             http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    
    <groupId>com.example</groupId>
    <artifactId>testng-annotations-demo</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>jar</packaging>
    
    <properties>
        <maven.compiler.source>11</maven.compiler.source>
        <maven.compiler.target>11</maven.compiler.target>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <testng.version>7.8.0</testng.version>
    </properties>
    
    <dependencies>
        <!-- TestNG -->
        <dependency>
            <groupId>org.testng</groupId>
            <artifactId>testng</artifactId>
            <version>${testng.version}</version>
            <scope>test</scope>
        </dependency>
    </dependencies>
    
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.11.0</version>
                <configuration>
                    <source>11</source>
                    <target>11</target>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>3.0.0</version>
                <configuration>
                    <suiteXmlFiles>
                        <suiteXmlFile>testng-smoke.xml</suiteXmlFile>
                    </suiteXmlFiles>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>
```

## 2. Custom Annotations

**SmokeTest.java**
```java
package com.example.annotations;

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface SmokeTest {
    String description() default "";
    String module() default "General";
    int priority() default 1;
}
```

**RegressionTest.java**
```java
package com.example.annotations;

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface RegressionTest {
    String description() default "";
    String module() default "General";
    String type() default "Functional";
    int priority() default 2;
}
```

**PerformanceTest.java**
```java
package com.example.annotations;

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface PerformanceTest {
    String description() default "";
    int expectedResponseTime() default 1000;
    int priority() default 3;
}
```

## 3. Model Classes

**User.java**
```java
package com.example.model;

public class User {
    private Long id;
    private String username;
    private String email;
    private boolean active;
    private double balance;
    
    public User() {}
    
    public User(Long id, String username, String email, double balance) {
        this.id = id;
        this.username = username;
        this.email = email;
        this.active = true;
        this.balance = balance;
    }
    
    // Getters and Setters
    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }
    
    public String getUsername() { return username; }
    public void setUsername(String username) { this.username = username; }
    
    public String getEmail() { return email; }
    public void setEmail(String email) { this.email = email; }
    
    public boolean isActive() { return active; }
    public void setActive(boolean active) { this.active = active; }
    
    public double getBalance() { return balance; }
    public void setBalance(double balance) { this.balance = balance; }
    
    @Override
    public String toString() {
        return String.format("User{id=%d, username='%s', email='%s', balance=%.2f}", 
                           id, username, email, balance);
    }
}
```

**Product.java**
```java
package com.example.model;

public class Product {
    private Long id;
    private String name;
    private String category;
    private double price;
    private int stockQuantity;
    
    public Product() {}
    
    public Product(Long id, String name, String category, double price, int stockQuantity) {
        this.id = id;
        this.name = name;
        this.category = category;
        this.price = price;
        this.stockQuantity = stockQuantity;
    }
    
    // Getters and Setters
    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }
    
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    
    public String getCategory() { return category; }
    public void setCategory(String category) { this.category = category; }
    
    public double getPrice() { return price; }
    public void setPrice(double price) { this.price = price; }
    
    public int getStockQuantity() { return stockQuantity; }
    public void setStockQuantity(int stockQuantity) { this.stockQuantity = stockQuantity; }
}
```

**Order.java**
```java
package com.example.model;

import java.time.LocalDateTime;
import java.util.ArrayList;
import java.util.List;

public class Order {
    private Long id;
    private Long userId;
    private List<Product> products;
    private double totalAmount;
    private OrderStatus status;
    private LocalDateTime orderDate;
    
    public enum OrderStatus {
        PENDING, CONFIRMED, SHIPPED, DELIVERED, CANCELLED
    }
    
    public Order() {
        this.products = new ArrayList<>();
        this.status = OrderStatus.PENDING;
        this.orderDate = LocalDateTime.now();
    }
    
    public Order(Long id, Long userId) {
        this();
        this.id = id;
        this.userId = userId;
    }
    
    // Getters and Setters
    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }
    
    public Long getUserId() { return userId; }
    public void setUserId(Long userId) { this.userId = userId; }
    
    public List<Product> getProducts() { return products; }
    public void setProducts(List<Product> products) { this.products = products; }
    
    public double getTotalAmount() { return totalAmount; }
    public void setTotalAmount(double totalAmount) { this.totalAmount = totalAmount; }
    
    public OrderStatus getStatus() { return status; }
    public void setStatus(OrderStatus status) { this.status = status; }
    
    public LocalDateTime getOrderDate() { return orderDate; }
    public void setOrderDate(LocalDateTime orderDate) { this.orderDate = orderDate; }
    
    public void addProduct(Product product) {
        this.products.add(product);
        calculateTotalAmount();
    }
    
    private void calculateTotalAmount() {
        this.totalAmount = products.stream()
                .mapToDouble(Product::getPrice)
                .sum();
    }
}
```

## 4. Service Classes

**UserService.java**
```java
package com.example.service;

import com.example.model.User;
import java.util.HashMap;
import java.util.Map;
import java.util.Optional;

public class UserService {
    private Map<Long, User> users = new HashMap<>();
    private Long nextId = 1L;
    
    public User createUser(String username, String email, double initialBalance) {
        if (username == null || username.trim().isEmpty()) {
            throw new IllegalArgumentException("Username cannot be null or empty");
        }
        
        if (email == null || !email.contains("@")) {
            throw new IllegalArgumentException("Invalid email address");
        }
        
        if (initialBalance < 0) {
            throw new IllegalArgumentException("Initial balance cannot be negative");
        }
        
        // Check if email already exists
        boolean emailExists = users.values().stream()
                .anyMatch(user -> user.getEmail().equalsIgnoreCase(email));
        
        if (emailExists) {
            throw new IllegalArgumentException("Email already exists: " + email);
        }
        
        User user = new User(nextId, username, email, initialBalance);
        users.put(nextId, user);
        nextId++;
        
        return user;
    }
    
    public Optional<User> getUserById(Long id) {
        return Optional.ofNullable(users.get(id));
    }
    
    public boolean updateUserBalance(Long userId, double amount) {
        User user = users.get(userId);
        if (user != null && user.isActive()) {
            double newBalance = user.getBalance() + amount;
            if (newBalance >= 0) {
                user.setBalance(newBalance);
                return true;
            }
        }
        return false;
    }
    
    public boolean deactivateUser(Long userId) {
        User user = users.get(userId);
        if (user != null) {
            user.setActive(false);
            return true;
        }
        return false;
    }
    
    public boolean activateUser(Long userId) {
        User user = users.get(userId);
        if (user != null) {
            user.setActive(true);
            return true;
        }
        return false;
    }
    
    public int getTotalUsers() {
        return users.size();
    }
    
    public int getActiveUsersCount() {
        return (int) users.values().stream()
                .filter(User::isActive)
                .count();
    }
    
    public void clearAllUsers() {
        users.clear();
        nextId = 1L;
    }
}
```

**PaymentService.java**
```java
package com.example.service;

import com.example.model.User;
import java.util.HashMap;
import java.util.Map;
import java.util.Optional;
import java.util.UUID;

public class PaymentService {
    private Map<String, String> transactions = new HashMap<>();
    
    public PaymentResult processPayment(Long userId, double amount, String paymentMethod) {
        if (userId == null || userId <= 0) {
            return new PaymentResult(false, null, "Invalid user ID", amount);
        }
        
        if (amount <= 0) {
            return new PaymentResult(false, null, "Invalid payment amount", amount);
        }
        
        if (paymentMethod == null || paymentMethod.trim().isEmpty()) {
            return new PaymentResult(false, null, "Payment method is required", amount);
        }
        
        // Simulate payment processing
        try {
            Thread.sleep(100); // Simulate processing time
            
            // Simulate random failures for testing
            if (Math.random() < 0.1) { // 10% failure rate for testing
                return new PaymentResult(false, null, "Payment gateway timeout", amount);
            }
            
            String transactionId = "TXN_" + UUID.randomUUID().toString().substring(0, 8).toUpperCase();
            transactions.put(transactionId, "COMPLETED");
            
            return new PaymentResult(true, transactionId, "Payment processed successfully", amount);
            
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            return new PaymentResult(false, null, "Payment processing interrupted", amount);
        }
    }
    
    public boolean refundPayment(String transactionId) {
        if (transactionId == null || !transactions.containsKey(transactionId)) {
            return false;
        }
        
        transactions.put(transactionId, "REFUNDED");
        return true;
    }
    
    public String getTransactionStatus(String transactionId) {
        return transactions.get(transactionId);
    }
    
    public static class PaymentResult {
        private final boolean success;
        private final String transactionId;
        private final String message;
        private final double amount;
        
        public PaymentResult(boolean success, String transactionId, String message, double amount) {
            this.success = success;
            this.transactionId = transactionId;
            this.message = message;
            this.amount = amount;
        }
        
        public boolean isSuccess() { return success; }
        public String getTransactionId() { return transactionId; }
        public String getMessage() { return message; }
        public double getAmount() { return amount; }
    }
}
```

**InventoryService.java**
```java
package com.example.service;

import com.example.model.Product;
import java.util.HashMap;
import java.util.Map;
import java.util.Optional;

public class InventoryService {
    private Map<Long, Product> products = new HashMap<>();
    private Map<String, Integer> categoryStock = new HashMap<>();
    private Long nextId = 1L;
    
    public Product addProduct(String name, String category, double price, int quantity) {
        if (name == null || name.trim().isEmpty()) {
            throw new IllegalArgumentException("Product name cannot be null or empty");
        }
        
        if (category == null || category.trim().isEmpty()) {
            throw new IllegalArgumentException("Category cannot be null or empty");
        }
        
        if (price <= 0) {
            throw new IllegalArgumentException("Price must be positive");
        }
        
        if (quantity < 0) {
            throw new IllegalArgumentException("Quantity cannot be negative");
        }
        
        Product product = new Product(nextId, name, category, price, quantity);
        products.put(nextId, product);
        
        // Update category stock
        categoryStock.merge(category, quantity, Integer::sum);
        
        nextId++;
        return product;
    }
    
    public Optional<Product> getProductById(Long id) {
        return Optional.ofNullable(products.get(id));
    }
    
    public boolean updateStock(Long productId, int newQuantity) {
        Product product = products.get(productId);
        if (product != null && newQuantity >= 0) {
            int oldQuantity = product.getStockQuantity();
            product.setStockQuantity(newQuantity);
            
            // Update category stock
            String category = product.getCategory();
            int currentCategoryStock = categoryStock.getOrDefault(category, 0);
            categoryStock.put(category, currentCategoryStock - oldQuantity + newQuantity);
            
            return true;
        }
        return false;
    }
    
    public boolean reserveProduct(Long productId, int quantity) {
        Product product = products.get(productId);
        if (product != null && product.getStockQuantity() >= quantity) {
            product.setStockQuantity(product.getStockQuantity() - quantity);
            return true;
        }
        return false;
    }
    
    public int getTotalProducts() {
        return products.size();
    }
    
    public int getTotalStock() {
        return products.values().stream()
                .mapToInt(Product::getStockQuantity)
                .sum();
    }
    
    public int getCategoryStock(String category) {
        return categoryStock.getOrDefault(category, 0);
    }
    
    public void clearInventory() {
        products.clear();
        categoryStock.clear();
        nextId = 1L;
    }
}
```

## 5. Test Classes with Custom Annotations

**UserServiceTest.java**
```java
package com.example.tests;

import com.example.annotations.SmokeTest;
import com.example.annotations.RegressionTest;
import com.example.annotations.PerformanceTest;
import com.example.service.UserService;
import com.example.model.User;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import java.util.Optional;

import static org.testng.Assert.*;

public class UserServiceTest {
    private UserService userService;
    
    @BeforeMethod
    public void setUp() {
        userService = new UserService();
        System.out.println("Setting up UserService test...");
    }
    
    @AfterMethod
    public void tearDown() {
        userService.clearAllUsers();
        System.out.println("Cleaning up after UserService test...");
    }
    
    @SmokeTest(description = "Create new user with valid data", module = "User Management", priority = 1)
    @Test
    public void testCreateUser_ValidData() {
        // Arrange & Act
        User user = userService.createUser("john_doe", "john@example.com", 1000.0);
        
        // Assert
        assertNotNull(user);
        assertEquals(user.getUsername(), "john_doe");
        assertEquals(user.getEmail(), "john@example.com");
        assertEquals(user.getBalance(), 1000.0, 0.001);
        assertTrue(user.isActive());
    }
    
    @SmokeTest(description = "Retrieve user by ID", module = "User Management", priority = 1)
    @Test
    public void testGetUserById_UserExists() {
        // Arrange
        User createdUser = userService.createUser("jane_doe", "jane@example.com", 500.0);
        
        // Act
        Optional<User> retrievedUser = userService.getUserById(createdUser.getId());
        
        // Assert
        assertTrue(retrievedUser.isPresent());
        assertEquals(retrievedUser.get().getUsername(), "jane_doe");
        assertEquals(retrievedUser.get().getEmail(), "jane@example.com");
    }
    
    @RegressionTest(description = "Create user with duplicate email", module = "User Management", type = "Negative")
    @Test
    public void testCreateUser_DuplicateEmail() {
        // Arrange
        userService.createUser("user1", "same@example.com", 100.0);
        
        // Act & Assert
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class, 
            () -> userService.createUser("user2", "same@example.com", 200.0));
        
        assertTrue(exception.getMessage().contains("Email already exists"));
    }
    
    @RegressionTest(description = "Create user with invalid email", module = "User Management", type = "Negative")
    @Test
    public void testCreateUser_InvalidEmail() {
        // Act & Assert
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class, 
            () -> userService.createUser("user1", "invalid-email", 100.0));
        
        assertTrue(exception.getMessage().contains("Invalid email address"));
    }
    
    @RegressionTest(description = "Update user balance successfully", module = "User Management", type = "Functional")
    @Test
    public void testUpdateUserBalance_Success() {
        // Arrange
        User user = userService.createUser("test_user", "test@example.com", 500.0);
        
        // Act
        boolean result = userService.updateUserBalance(user.getId(), 250.0);
        
        // Assert
        assertTrue(result);
        Optional<User> updatedUser = userService.getUserById(user.getId());
        assertTrue(updatedUser.isPresent());
        assertEquals(updatedUser.get().getBalance(), 750.0, 0.001);
    }
    
    @RegressionTest(description = "Update balance for non-existent user", module = "User Management", type = "Negative")
    @Test
    public void testUpdateUserBalance_UserNotFound() {
        // Act
        boolean result = userService.updateUserBalance(999L, 100.0);
        
        // Assert
        assertFalse(result);
    }
    
    @PerformanceTest(description = "User creation performance", expectedResponseTime = 500)
    @Test
    public void testUserCreation_Performance() {
        long startTime = System.currentTimeMillis();
        
        // Create multiple users to test performance
        for (int i = 0; i < 100; i++) {
            userService.createUser("user_" + i, "user" + i + "@example.com", 100.0);
        }
        
        long endTime = System.currentTimeMillis();
        long duration = endTime - startTime;
        
        assertTrue(duration < 1000, "User creation should complete within 1 second");
        assertEquals(userService.getTotalUsers(), 100);
    }
    
    @SmokeTest(description = "Deactivate active user", module = "User Management", priority = 2)
    @Test
    public void testDeactivateUser() {
        // Arrange
        User user = userService.createUser("active_user", "active@example.com", 300.0);
        
        // Act
        boolean result = userService.deactivateUser(user.getId());
        
        // Assert
        assertTrue(result);
        Optional<User> deactivatedUser = userService.getUserById(user.getId());
        assertTrue(deactivatedUser.isPresent());
        assertFalse(deactivatedUser.get().isActive());
    }
    
    @RegressionTest(description = "Get user statistics", module = "User Management", type = "Functional")
    @Test
    public void testUserStatistics() {
        // Arrange
        userService.createUser("user1", "user1@example.com", 100.0);
        userService.createUser("user2", "user2@example.com", 200.0);
        userService.createUser("user3", "user3@example.com", 300.0);
        
        // Deactivate one user
        userService.deactivateUser(1L);
        
        // Assert
        assertEquals(userService.getTotalUsers(), 3);
        assertEquals(userService.getActiveUsersCount(), 2);
    }
}
```

**PaymentServiceTest.java**
```java
package com.example.tests;

import com.example.annotations.SmokeTest;
import com.example.annotations.RegressionTest;
import com.example.annotations.PerformanceTest;
import com.example.service.PaymentService;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import static org.testng.Assert.*;

public class PaymentServiceTest {
    private PaymentService paymentService;
    
    @BeforeMethod
    public void setUp() {
        paymentService = new PaymentService();
    }
    
    @SmokeTest(description = "Process successful payment", module = "Payment", priority = 1)
    @Test
    public void testProcessPayment_Success() {
        // Act
        PaymentService.PaymentResult result = paymentService.processPayment(1L, 100.0, "CREDIT_CARD");
        
        // Assert
        assertTrue(result.isSuccess());
        assertNotNull(result.getTransactionId());
        assertTrue(result.getTransactionId().startsWith("TXN_"));
        assertEquals(result.getAmount(), 100.0, 0.001);
        assertEquals(result.getMessage(), "Payment processed successfully");
    }
    
    @RegressionTest(description = "Process payment with invalid amount", module = "Payment", type = "Negative")
    @Test
    public void testProcessPayment_InvalidAmount() {
        // Act
        PaymentService.PaymentResult result = paymentService.processPayment(1L, -50.0, "CREDIT_CARD");
        
        // Assert
        assertFalse(result.isSuccess());
        assertNull(result.getTransactionId());
        assertEquals(result.getMessage(), "Invalid payment amount");
    }
    
    @RegressionTest(description = "Process payment with empty payment method", module = "Payment", type = "Negative")
    @Test
    public void testProcessPayment_EmptyPaymentMethod() {
        // Act
        PaymentService.PaymentResult result = paymentService.processPayment(1L, 100.0, "");
        
        // Assert
        assertFalse(result.isSuccess());
        assertNull(result.getTransactionId());
        assertEquals(result.getMessage(), "Payment method is required");
    }
    
    @PerformanceTest(description = "Payment processing performance", expectedResponseTime = 2000)
    @Test
    public void testPaymentProcessing_Performance() {
        long startTime = System.currentTimeMillis();
        
        // Process multiple payments
        for (int i = 0; i < 50; i++) {
            paymentService.processPayment((long) i, 10.0 + i, "CREDIT_CARD");
        }
        
        long endTime = System.currentTimeMillis();
        long duration = endTime - startTime;
        
        assertTrue(duration < 10000, "Payment processing should complete within 10 seconds");
    }
    
    @RegressionTest(description = "Refund successful payment", module = "Payment", type = "Functional")
    @Test
    public void testRefundPayment() {
        // Arrange
        PaymentService.PaymentResult payment = paymentService.processPayment(1L, 150.0, "CREDIT_CARD");
        
        // Act
        boolean refundResult = paymentService.refundPayment(payment.getTransactionId());
        
        // Assert
        assertTrue(refundResult);
        assertEquals(paymentService.getTransactionStatus(payment.getTransactionId()), "REFUNDED");
    }
    
    @RegressionTest(description = "Refund non-existent transaction", module = "Payment", type = "Negative")
    @Test
    public void testRefundPayment_InvalidTransaction() {
        // Act
        boolean refundResult = paymentService.refundPayment("INVALID_TXN");
        
        // Assert
        assertFalse(refundResult);
    }
}
```

**InventoryServiceTest.java**
```java
package com.example.tests;

import com.example.annotations.SmokeTest;
import com.example.annotations.RegressionTest;
import com.example.annotations.PerformanceTest;
import com.example.service.InventoryService;
import com.example.model.Product;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import java.util.Optional;

import static org.testng.Assert.*;

public class InventoryServiceTest {
    private InventoryService inventoryService;
    
    @BeforeMethod
    public void setUp() {
        inventoryService = new InventoryService();
    }
    
    @SmokeTest(description = "Add product to inventory", module = "Inventory", priority = 1)
    @Test
    public void testAddProduct_ValidData() {
        // Act
        Product product = inventoryService.addProduct("Laptop", "Electronics", 999.99, 10);
        
        // Assert
        assertNotNull(product);
        assertEquals(product.getName(), "Laptop");
        assertEquals(product.getCategory(), "Electronics");
        assertEquals(product.getPrice(), 999.99, 0.001);
        assertEquals(product.getStockQuantity(), 10);
    }
    
    @RegressionTest(description = "Add product with negative price", module = "Inventory", type = "Negative")
    @Test
    public void testAddProduct_NegativePrice() {
        // Act & Assert
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
            () -> inventoryService.addProduct("Product", "Category", -10.0, 5));
        
        assertTrue(exception.getMessage().contains("Price must be positive"));
    }
    
    @RegressionTest(description = "Update product stock", module = "Inventory", type = "Functional")
    @Test
    public void testUpdateStock() {
        // Arrange
        Product product = inventoryService.addProduct("Mouse", "Electronics", 25.99, 50);
        
        // Act
        boolean result = inventoryService.updateStock(product.getId(), 30);
        
        // Assert
        assertTrue(result);
        Optional<Product> updatedProduct = inventoryService.getProductById(product.getId());
        assertTrue(updatedProduct.isPresent());
        assertEquals(updatedProduct.get().getStockQuantity(), 30);
    }
    
    @SmokeTest(description = "Reserve product from inventory", module = "Inventory", priority = 2)
    @Test
    public void testReserveProduct_Success() {
        // Arrange
        Product product = inventoryService.addProduct("Keyboard", "Electronics", 75.50, 20);
        
        // Act
        boolean result = inventoryService.reserveProduct(product.getId(), 5);
        
        // Assert
        assertTrue(result);
        Optional<Product> updatedProduct = inventoryService.getProductById(product.getId());
        assertTrue(updatedProduct.isPresent());
        assertEquals(updatedProduct.get().getStockQuantity(), 15);
    }
    
    @RegressionTest(description = "Reserve more than available stock", module = "Inventory", type = "Negative")
    @Test
    public void testReserveProduct_InsufficientStock() {
        // Arrange
        Product product = inventoryService.addProduct("Monitor", "Electronics", 299.99, 3);
        
        // Act
        boolean result = inventoryService.reserveProduct(product.getId(), 5);
        
        // Assert
        assertFalse(result);
        Optional<Product> unchangedProduct = inventoryService.getProductById(product.getId());
        assertTrue(unchangedProduct.isPresent());
        assertEquals(unchangedProduct.get().getStockQuantity(), 3);
    }
    
    @PerformanceTest(description = "Inventory management performance", expectedResponseTime = 1500)
    @Test
    public void testInventoryManagement_Performance() {
        long startTime = System.currentTimeMillis();
        
        // Add multiple products
        for (int i = 0; i < 100; i++) {
            inventoryService.addProduct("Product_" + i, "Category_" + (i % 5), 10.0 + i, i * 2);
        }
        
        // Update some stocks
        for (int i = 1; i <= 50; i++) {
            inventoryService.updateStock((long) i, 100);
        }
        
        long endTime = System.currentTimeMillis();
        long duration = endTime - startTime;
        
        assertTrue(duration < 3000, "Inventory operations should complete within 3 seconds");
        assertEquals(inventoryService.getTotalProducts(), 100);
    }
    
    @RegressionTest(description = "Get category stock statistics", module = "Inventory", type = "Functional")
    @Test
    public void testCategoryStock() {
        // Arrange
        inventoryService.addProduct("Laptop", "Electronics", 1000.0, 5);
        inventoryService.addProduct("Mouse", "Electronics", 25.0, 20);
        inventoryService.addProduct("Desk", "Furniture", 200.0, 3);
        inventoryService.addProduct("Chair", "Furniture", 150.0, 8);
        
        // Assert
        assertEquals(inventoryService.getCategoryStock("Electronics"), 25);
        assertEquals(inventoryService.getCategoryStock("Furniture"), 11);
        assertEquals(inventoryService.getCategoryStock("NonExistent"), 0);
        assertEquals(inventoryService.getTotalStock(), 36);
    }
}
```

**ComprehensiveTest.java**
```java
package com.example.tests;

import com.example.annotations.SmokeTest;
import com.example.annotations.RegressionTest;
import com.example.service.UserService;
import com.example.service.PaymentService;
import com.example.service.InventoryService;
import com.example.model.User;
import org.testng.annotations.Test;

import static org.testng.Assert.*;

public class ComprehensiveTest {
    
    @RegressionTest(description = "Complete user purchase flow", module = "E2E", type = "Integration")
    @Test
    public void testCompleteUserPurchaseFlow() {
        // Setup services
        UserService userService = new UserService();
        PaymentService paymentService = new PaymentService();
        InventoryService inventoryService = new InventoryService();
        
        try {
            // Step 1: Create user
            User user = userService.createUser("test_customer", "customer@example.com", 1000.0);
            assertNotNull(user);
            assertTrue(user.isActive());
            
            // Step 2: Add products to inventory
            var product1 = inventoryService.addProduct("Smartphone", "Electronics", 599.99, 10);
            var product2 = inventoryService.addProduct("Case", "Accessories", 19.99, 50);
            
            // Step 3: Reserve products
            boolean reserve1 = inventoryService.reserveProduct(product1.getId(), 1);
            boolean reserve2 = inventoryService.reserveProduct(product2.getId(), 1);
            assertTrue(reserve1);
            assertTrue(reserve2);
            
            // Step 4: Process payment
            double totalAmount = 599.99 + 19.99;
            var paymentResult = paymentService.processPayment(user.getId(), totalAmount, "CREDIT_CARD");
            assertTrue(paymentResult.isSuccess());
            
            // Step 5: Verify inventory updated
            var updatedProduct1 = inventoryService.getProductById(product1.getId());
            assertTrue(updatedProduct1.isPresent());
            assertEquals(updatedProduct1.get().getStockQuantity(), 9);
            
            // Step 6: Verify user balance (simulated update)
            boolean balanceUpdated = userService.updateUserBalance(user.getId(), -totalAmount);
            assertTrue(balanceUpdated);
            
            var updatedUser = userService.getUserById(user.getId());
            assertTrue(updatedUser.isPresent());
            assertEquals(updatedUser.get().getBalance(), 1000.0 - totalAmount, 0.001);
            
        } finally {
            // Cleanup
            userService.clearAllUsers();
            inventoryService.clearInventory();
        }
    }
    
    @SmokeTest(description = "Multiple service integration test", module = "Integration", priority = 1)
    @Test
    public void testMultipleServiceIntegration() {
        UserService userService = new UserService();
        PaymentService paymentService = new PaymentService();
        
        // Create multiple users and process payments
        for (int i = 0; i < 5; i++) {
            User user = userService.createUser("user_" + i, "user" + i + "@example.com", 100.0 * (i + 1));
            assertNotNull(user);
            
            PaymentService.PaymentResult result = paymentService.processPayment(
                user.getId(), 50.0, "CREDIT_CARD");
            assertTrue(result.isSuccess());
        }
        
        assertEquals(userService.getTotalUsers(), 5);
        assertEquals(userService.getActiveUsersCount(), 5);
    }
}
```

## 6. Custom Test Listener

**CustomTestListener.java**
```java
package com.example.listeners;

import com.example.annotations.SmokeTest;
import com.example.annotations.RegressionTest;
import com.example.annotations.PerformanceTest;
import org.testng.ITestListener;
import org.testng.ITestResult;

public class CustomTestListener implements ITestListener {
    
    @Override
    public void onTestStart(ITestResult result) {
        System.out.println("=== Starting Test: " + result.getName() + " ===");
        
        // Log annotation information
        SmokeTest smokeTest = result.getMethod().getConstructorOrMethod()
            .getMethod().getAnnotation(SmokeTest.class);
        RegressionTest regressionTest = result.getMethod().getConstructorOrMethod()
            .getMethod().getAnnotation(RegressionTest.class);
        PerformanceTest performanceTest = result.getMethod().getConstructorOrMethod()
            .getMethod().getAnnotation(PerformanceTest.class);
        
        if (smokeTest != null) {
            System.out.println("ðŸ§ª SMOKE TEST - " + smokeTest.description() + 
                             " [Module: " + smokeTest.module() + ", Priority: " + smokeTest.priority() + "]");
        }
        
        if (regressionTest != null) {
            System.out.println("ðŸ” REGRESSION TEST - " + regressionTest.description() + 
                             " [Module: " + regressionTest.module() + ", Type: " + regressionTest.type() + "]");
        }
        
        if (performanceTest != null) {
            System.out.println("âš¡ PERFORMANCE TEST - " + performanceTest.description() + 
                             " [Expected Response: " + performanceTest.expectedResponseTime() + "ms]");
        }
    }
    
    @Override
    public void onTestSuccess(ITestResult result) {
        System.out.println("âœ… TEST PASSED: " + result.getName());
        System.out.println("Execution time: " + (result.getEndMillis() - result.getStartMillis()) + "ms\n");
    }
    
    @Override
    public void onTestFailure(ITestResult result) {
        System.out.println("âŒ TEST FAILED: " + result.getName());
        System.out