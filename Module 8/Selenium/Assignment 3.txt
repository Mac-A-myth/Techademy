2. Model Classes

User.java
java

package com.example.model;

public class User {
    private String username;
    private String email;
    private String password;
    private int age;
    private boolean active;
    
    public User() {}
    
    public User(String username, String email, String password, int age, boolean active) {
        this.username = username;
        this.email = email;
        this.password = password;
        this.age = age;
        this.active = active;
    }
    
    // Getters and Setters
    public String getUsername() { return username; }
    public void setUsername(String username) { this.username = username; }
    
    public String getEmail() { return email; }
    public void setEmail(String email) { this.email = email; }
    
    public String getPassword() { return password; }
    public void setPassword(String password) { this.password = password; }
    
    public int getAge() { return age; }
    public void setAge(int age) { this.age = age; }
    
    public boolean isActive() { return active; }
    public void setActive(boolean active) { this.active = active; }
    
    @Override
    public String toString() {
        return String.format("User{username='%s', email='%s', age=%d, active=%s}", 
                           username, email, age, active);
    }
}

Product.java
java

package com.example.model;

public class Product {
    private String name;
    private String category;
    private double price;
    private int quantity;
    private boolean inStock;
    
    public Product() {}
    
    public Product(String name, String category, double price, int quantity, boolean inStock) {
        this.name = name;
        this.category = category;
        this.price = price;
        this.quantity = quantity;
        this.inStock = inStock;
    }
    
    // Getters and Setters
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    
    public String getCategory() { return category; }
    public void setCategory(String category) { this.category = category; }
    
    public double getPrice() { return price; }
    public void setPrice(double price) { this.price = price; }
    
    public int getQuantity() { return quantity; }
    public void setQuantity(int quantity) { this.quantity = quantity; }
    
    public boolean isInStock() { return inStock; }
    public void setInStock(boolean inStock) { this.inStock = inStock; }
    
    @Override
    public String toString() {
        return String.format("Product{name='%s', category='%s', price=%.2f, quantity=%d, inStock=%s}", 
                           name, category, price, quantity, inStock);
    }
}

3. Service Classes

CalculatorService.java
java

package com.example.service;

public class CalculatorService {
    
    public double add(double a, double b) {
        return a + b;
    }
    
    public double subtract(double a, double b) {
        return a - b;
    }
    
    public double multiply(double a, double b) {
        return a * b;
    }
    
    public double divide(double a, double b) {
        if (b == 0) {
            throw new ArithmeticException("Division by zero is not allowed");
        }
        return a / b;
    }
    
    public double power(double base, double exponent) {
        return Math.pow(base, exponent);
    }
    
    public double squareRoot(double number) {
        if (number < 0) {
            throw new IllegalArgumentException("Cannot calculate square root of negative number");
        }
        return Math.sqrt(number);
    }
    
    public boolean isPrime(int number) {
        if (number <= 1) return false;
        if (number == 2) return true;
        if (number % 2 == 0) return false;
        
        for (int i = 3; i <= Math.sqrt(number); i += 2) {
            if (number % i == 0) return false;
        }
        return true;
    }
    
    public int factorial(int n) {
        if (n < 0) {
            throw new IllegalArgumentException("Factorial is not defined for negative numbers");
        }
        if (n == 0 || n == 1) return 1;
        
        int result = 1;
        for (int i = 2; i <= n; i++) {
            result *= i;
        }
        return result;
    }
}

UserService.java
java

package com.example.service;

import com.example.model.User;
import java.util.ArrayList;
import java.util.List;
import java.util.regex.Pattern;

public class UserService {
    private List<User> users = new ArrayList<>();
    private static final Pattern EMAIL_PATTERN = 
        Pattern.compile("^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+$");
    private static final Pattern USERNAME_PATTERN = 
        Pattern.compile("^[a-zA-Z0-9_]{3,20}$");
    
    public User registerUser(String username, String email, String password, int age) {
        // Validate inputs
        if (!isValidUsername(username)) {
            throw new IllegalArgumentException("Invalid username format");
        }
        
        if (!isValidEmail(email)) {
            throw new IllegalArgumentException("Invalid email format");
        }
        
        if (password == null || password.length() < 6) {
            throw new IllegalArgumentException("Password must be at least 6 characters long");
        }
        
        if (age < 13 || age > 120) {
            throw new IllegalArgumentException("Age must be between 13 and 120");
        }
        
        // Check if username or email already exists
        if (isUsernameTaken(username)) {
            throw new IllegalArgumentException("Username already taken: " + username);
        }
        
        if (isEmailTaken(email)) {
            throw new IllegalArgumentException("Email already registered: " + email);
        }
        
        User user = new User(username, email, password, age, true);
        users.add(user);
        return user;
    }
    
    public boolean login(String username, String password) {
        return users.stream()
                .filter(User::isActive)
                .anyMatch(user -> user.getUsername().equals(username) && 
                                 user.getPassword().equals(password));
    }
    
    public boolean deactivateUser(String username) {
        for (User user : users) {
            if (user.getUsername().equals(username)) {
                user.setActive(false);
                return true;
            }
        }
        return false;
    }
    
    public User updateUserAge(String username, int newAge) {
        if (newAge < 13 || newAge > 120) {
            throw new IllegalArgumentException("Age must be between 13 and 120");
        }
        
        for (User user : users) {
            if (user.getUsername().equals(username)) {
                user.setAge(newAge);
                return user;
            }
        }
        throw new IllegalArgumentException("User not found: " + username);
    }
    
    private boolean isValidUsername(String username) {
        return username != null && USERNAME_PATTERN.matcher(username).matches();
    }
    
    private boolean isValidEmail(String email) {
        return email != null && EMAIL_PATTERN.matcher(email).matches();
    }
    
    private boolean isUsernameTaken(String username) {
        return users.stream().anyMatch(user -> user.getUsername().equals(username));
    }
    
    private boolean isEmailTaken(String email) {
        return users.stream().anyMatch(user -> user.getEmail().equals(email));
    }
    
    public int getUserCount() {
        return users.size();
    }
    
    public int getActiveUserCount() {
        return (int) users.stream().filter(User::isActive).count();
    }
    
    public void clearAllUsers() {
        users.clear();
    }
}

ProductService.java
java

package com.example.service;

import com.example.model.Product;
import java.util.ArrayList;
import java.util.List;
import java.util.stream.Collectors;

public class ProductService {
    private List<Product> products = new ArrayList<>();
    
    public Product addProduct(String name, String category, double price, int quantity) {
        // Validate inputs
        if (name == null || name.trim().isEmpty()) {
            throw new IllegalArgumentException("Product name cannot be empty");
        }
        
        if (category == null || category.trim().isEmpty()) {
            throw new IllegalArgumentException("Category cannot be empty");
        }
        
        if (price <= 0) {
            throw new IllegalArgumentException("Price must be positive");
        }
        
        if (quantity < 0) {
            throw new IllegalArgumentException("Quantity cannot be negative");
        }
        
        // Check if product already exists
        if (products.stream().anyMatch(p -> p.getName().equalsIgnoreCase(name))) {
            throw new IllegalArgumentException("Product already exists: " + name);
        }
        
        Product product = new Product(name, category, price, quantity, quantity > 0);
        products.add(product);
        return product;
    }
    
    public Product updateProductPrice(String productName, double newPrice) {
        if (newPrice <= 0) {
            throw new IllegalArgumentException("Price must be positive");
        }
        
        for (Product product : products) {
            if (product.getName().equalsIgnoreCase(productName)) {
                product.setPrice(newPrice);
                return product;
            }
        }
        throw new IllegalArgumentException("Product not found: " + productName);
    }
    
    public boolean purchaseProduct(String productName, int quantity) {
        if (quantity <= 0) {
            throw new IllegalArgumentException("Purchase quantity must be positive");
        }
        
        for (Product product : products) {
            if (product.getName().equalsIgnoreCase(productName)) {
                if (product.getQuantity() >= quantity) {
                    product.setQuantity(product.getQuantity() - quantity);
                    product.setInStock(product.getQuantity() > 0);
                    return true;
                } else {
                    return false; // Insufficient stock
                }
            }
        }
        return false; // Product not found
    }
    
    public List<Product> getProductsByCategory(String category) {
        return products.stream()
                .filter(p -> p.getCategory().equalsIgnoreCase(category))
                .collect(Collectors.toList());
    }
    
    public List<Product> getProductsInStock() {
        return products.stream()
                .filter(Product::isInStock)
                .collect(Collectors.toList());
    }
    
    public double getTotalInventoryValue() {
        return products.stream()
                .mapToDouble(p -> p.getPrice() * p.getQuantity())
                .sum();
    }
    
    public void restockProduct(String productName, int additionalQuantity) {
        if (additionalQuantity <= 0) {
            throw new IllegalArgumentException("Restock quantity must be positive");
        }
        
        for (Product product : products) {
            if (product.getName().equalsIgnoreCase(productName)) {
                product.setQuantity(product.getQuantity() + additionalQuantity);
                product.setInStock(true);
                return;
            }
        }
        throw new IllegalArgumentException("Product not found: " + productName);
    }
    
    public void clearAllProducts() {
        products.clear();
    }
    
    public int getProductCount() {
        return products.size();
    }
}

4. Utility Classes for Data Reading

DataFileReader.java
java

package com.example.utils;

import com.example.model.User;
import com.example.model.Product;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.opencsv.CSVReader;
import com.opencsv.exceptions.CsvException;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.*;
import java.util.*;

public class DataFileReader {
    private static final ObjectMapper objectMapper = new ObjectMapper();
    
    // Read CSV file and return list of string arrays
    public static List<String[]> readCSV(String filePath) {
        List<String[]> data = new ArrayList<>();
        try (CSVReader reader = new CSVReader(new FileReader(filePath))) {
            data = reader.readAll();
            // Skip header row
            if (!data.isEmpty()) {
                data.remove(0);
            }
        } catch (IOException | CsvException e) {
            throw new RuntimeException("Error reading CSV file: " + filePath, e);
        }
        return data;
    }
    
    // Read JSON file and return list of users
    public static List<User> readUsersFromJson(String filePath) {
        try {
            return objectMapper.readValue(
                new File(filePath), 
                new TypeReference<List<User>>() {}
            );
        } catch (IOException e) {
            throw new RuntimeException("Error reading JSON file: " + filePath, e);
        }
    }
    
    // Read JSON file and return list of products
    public static List<Product> readProductsFromJson(String filePath) {
        try {
            return objectMapper.readValue(
                new File(filePath), 
                new TypeReference<List<Product>>() {}
            );
        } catch (IOException e) {
            throw new RuntimeException("Error reading JSON file: " + filePath, e);
        }
    }
    
    // Read Excel file and return test data
    public static Object[][] readExcelData(String filePath, String sheetName) {
        List<Object[]> testData = new ArrayList<>();
        
        try (FileInputStream fis = new FileInputStream(filePath);
             Workbook workbook = new XSSFWorkbook(fis)) {
            
            Sheet sheet = workbook.getSheet(sheetName);
            Iterator<Row> rowIterator = sheet.iterator();
            
            // Skip header row
            if (rowIterator.hasNext()) {
                rowIterator.next();
            }
            
            while (rowIterator.hasNext()) {
                Row row = rowIterator.next();
                List<Object> rowData = new ArrayList<>();
                
                Iterator<Cell> cellIterator = row.cellIterator();
                while (cellIterator.hasNext()) {
                    Cell cell = cellIterator.next();
                    switch (cell.getCellType()) {
                        case NUMERIC:
                            if (DateUtil.isCellDateFormatted(cell)) {
                                rowData.add(cell.getDateCellValue());
                            } else {
                                rowData.add(cell.getNumericCellValue());
                            }
                            break;
                        case STRING:
                            rowData.add(cell.getStringCellValue());
                            break;
                        case BOOLEAN:
                            rowData.add(cell.getBooleanCellValue());
                            break;
                        default:
                            rowData.add(null);
                    }
                }
                testData.add(rowData.toArray());
            }
            
        } catch (IOException e) {
            throw new RuntimeException("Error reading Excel file: " + filePath, e);
        }
        
        return testData.toArray(new Object[0][]);
    }
    
    // Generate random test data
    public static Object[][] generateRandomUserData(int count) {
        Object[][] data = new Object[count][4]; // username, email, password, age
        Random random = new Random();
        
        for (int i = 0; i < count; i++) {
            String username = "user" + (i + 1) + "_" + System.currentTimeMillis();
            String email = username + "@example.com";
            String password = "Pass123!";

